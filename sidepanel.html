<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>灵感库</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="tab-bar">
    <div class="tab-item active" data-tab="view-ideas">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
        灵感 <span id="ideaCount" style="margin-left: 4px; font-size: 11px; background: #eee; padding: 1px 5px; border-radius: 10px; color: #666; display: none;">0</span>
    </div>
    <div class="tab-item" data-tab="view-chat">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
        对话
    </div>
    <div class="tab-item" id="btnHelp" data-tab="view-help" style="flex: 0 0 40px; border-left: 1px solid var(--border);">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
        </svg>
    </div>
  </div>
  
  <div id="view-login" class="view-container login-view" style="display: none;">
    <div class="login-content">
        <img src="icons/icon128.png" class="login-logo">
        <h2 class="login-title">快采集</h2>
        <p class="login-desc">
            全能创作灵感采集器：无论网页、文字、图片、视频、话题，遇到灵感就能一键采集，还能跟AI对话进行即兴创作哦～
        </p>
        <button id="btnLoginJump" class="btn-primary login-btn">🚀 前往快传号登录</button>
        <button id="btnCheckLogin" class="btn-secondary login-btn">🔄 我已登录，同步状态</button>
        <div id="loginMsg" class="login-msg"></div>
    </div>
  </div>

  <div id="view-ideas" class="view-container active">
    <div class="header-area" style="flex-direction: column; align-items: stretch; padding-bottom: 0;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
         <div class="filter-tabs" style="display: flex; gap: 8px; overflow-x: auto; white-space: nowrap; padding-bottom: 4px;">
            <span class="filter-chip active" data-type="all">全部</span>
            <span class="filter-chip" data-type="text">笔记</span>
            <span class="filter-chip" data-type="image">图片</span>
            <span class="filter-chip" data-type="video">视频</span>
            <span class="filter-chip" data-type="link_grab">网页</span>
        </div>
        <button id="btnAdd" class="btn-icon-add" title="新增采集" style="flex-shrink:0; margin-left:8px;">＋</button>
      </div>
    </div>
    
    <div id="add-input-area" class="add-panel" style="display: none;">
      <textarea id="manualInput" placeholder="输入灵感内容，可包含文字、图片、视频、链接..."></textarea>
      <div class="add-actions">
        <button id="btnManualSubmit" class="btn-submit">保存</button>
      </div>
    </div>
    <div id="ideasList" class="ideas-list"></div>
  </div>

  <div id="view-chat" class="view-container">
    <div id="chatHistory" class="chat-history">
      <div class="chat-welcome">
        <p>👋 嗨！我是你的创作助手，想聊点什么</p>
        <p>PS：引用采集的灵感后再来对话中进行激情创作</p>
      </div>
    </div>
    
    <div id="chat-suggestions" class="chat-suggestions">
        <!-- JS populated -->
    </div>

    <div class="chat-input-area">
      <div style="display:flex; gap:8px; width:100%; align-items:flex-end;">
         <div style="flex:1; position:relative; display:flex; align-items:center; background:var(--bg-body); border-radius:20px; padding:4px 12px; border:1px solid var(--border);">
            <textarea id="chatInput" placeholder="问我任何问题～" style="border:none; background:transparent; padding:8px 0; height:24px; min-height:24px; max-height:100px; resize:none; flex:1; outline:none; font-size:14px;"></textarea>
            <button id="btnSendChat" style="background:var(--text-main); color:var(--bg-card); border-radius:50%; width:28px; height:28px; display:flex; align-items:center; justify-content:center; border:none; margin-left:8px; cursor:pointer;">➤</button>
         </div>
      </div>
    </div>
  </div>

  <div id="view-help" class="view-container" style="display: none; height: 100%; padding: 0;">
      <iframe src="welcome.html" style="width: 100%; height: 100%; border: none;"></iframe>
  </div>

  <script src="sidepanel.js"></script>
</body>
</html>
